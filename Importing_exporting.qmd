---
title: "Import/export data"
author: Vladimir Buskin
format:
  html:
    self-contained: true
    theme: default
    toc: true
    number-sections: true
    slide-number: true
    incremental: false
    slide-level: 3
    scrollable: true
    
editor: visual
---

::: callout-tip
## Script

You can find the full R script associated with this unit
[here](https://osf.io/puyrf).
:::


## Recommended reading

> @winter_statistics_2020: Chapter 1.11

## Preparation

The first section of an R-script always specifies the libraries that are
needed for executing the code to follow. In this unit, we will need
`readxl` and `writexl` to aid us with importing MS Excel files.

```{r}
library(readxl)
library(writexl)
```

Simply copy the code lines above into your script and execute them.

### Exporting data

Assume we'd like to save our data frame with word frequencies to a local
folder on our system. Let's briefly regenerate it:

```{r}
# Generate data frame
data <- data.frame(lemma = c("start", "enjoy", "begin", "help"), 
                   frequency = c(418, 139, 337, 281))

# Print contents
print(data)
```

There are two common formats in which tabular data can be stored on your
computer:

-   in .**csv**-files ('**c**omma-**s**eparated **v**alues'; native
    format of LibreOffice Calc)

-   .**xls**/.**xlsx-files** (Microsoft Excel files)

::: {.callout-note collapse="true" title="Export to CSV"}
To save our `data` data frame in .csv-format, we can use the
`write_table()` function:

```{r}
write.csv(data, "frequency_data.csv")
```

The file is now stored at the location of your current R-script. You can
open this file ...

-   in **LibreOffice**

-   in **Microsoft Excel** via `File` \> `Import` \> `CSV file` \>
    Select the file \> `Delimited` and then `Next` \> `Comma` and `Next`
    \> `General` and `Finish`.

Clearly, opening CSV files in MS Excel is quite cumbersome, which is why
it's better to export it as an Excel file directly.
:::

::: {.callout-note collapse="true" title="Export to Excel"}
We use `write_xlsx()` provided by the package `writexl` package:

```{r}
write_xlsx(data, "frequency_data.xlsx")
```

The file is now stored at the location of your current R-script. You
should be able to open it in MS Excel without any issues.
:::

### Importing data {#sec-import}

Let's read the two files back into R.

::: {.callout-note collapse="true" title="Import from CSV"}
To import the CSV file, we can use the `read.csv()` function:

```{r}
imported_csv <- read.csv("frequency_data.csv")
print(imported_csv)
```

It appears that `read.csv()` has also written the row numbers to the file. This is not the desired outcome and can be prevented by adding an additional argument:

```{r}
imported_csv <- read.csv("frequency_data.csv", row.names = 1)
print(imported_csv) # Problem solved!
```
:::

::: {.callout-note collapse="true" title="Import from Excel"}
For importing the Excel file, we'll use the `read_xlsx()` function from
the `readxl` package:

```{r}
imported_excel <- read_xlsx("frequency_data.xlsx")
print(imported_excel)
```
:::

That's it! Nevertheless, remember to always check your imported data to
ensure it has been read in correctly, especially when working with CSV
files.

## A convenient alternative: RDS files

If the main goal is to save an intermediary result and make it available for later use, the most efficient solution would be to save the object to a local R data file ending in `.RDS`. Since it performs data compression as well, .RDS files can be considered analogous to .zip files, which are very commonly used for other data types.

In practice, we use the `saveRDS()` function and supply it with ...

-   ... an R object (e.g., a vector, data frame, matrix, graphs, statistical models -- anything goes!) as well as 

-   ... the desired name of the file.

```{r}
# Save data frame "data" to the file "frequency_data.RDS"
saveRDS(data, "frequency_data.RDS")
```

To read a file back in, we need to indicate the file name (or the full file path if the file is located in a different folder).

```{r}
# Read in "frequency_data.RDS" and assign the contents to "data2"
data2 <- readRDS("frequency_data.RDS")

# Verify contents
print(data2)
```

