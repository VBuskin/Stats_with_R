---
title: "Exploratory Factor Analysis"
author: Vladimir Buskin
format:
  html:
    self-contained: true
    code-fold: false
    theme: default
    toc: true
    toc-depth: 4
    number-sections: true
    slide-number: true
    incremental: false
    slide-level: 3
    scrollable: true
editor: visual
bibliography: R.bib
metadata-files:
  - _quarto.yml
google-scholar: false
---

## Recommended reading

For linguists:

> Levshina [-@levshina_how_2015: Chapter 18]

General:

> Mair [-@mairModernPsychometrics2018: Chapter 2]

## Preparation

The implementation of Exploratory Factor Analysis in R is very similar
to that of Principle Components Analysis. To highlight these
similarities, we will use the same libraries (most importantly `psych`)
and the same dataset `scope_sem_sub` as in the unit on PCA (see
@sec-pca-prep for further details).

```{r}
# Load libraries
library(tidyverse)
library(purrr)
library(psych)
library(GPArotation)
library(gridExtra)

# Load data
scope_sem_df <- readRDS("scope_sem.RDS")

# Select subset
scope_sem_sub <- scope_sem_df[,1:11]

# Overview
glimpse(scope_sem_sub)
```

## Exploratory Factor Analysis vs. PCA

Exploratory Factor Analysis (EFA) is quite similar to PCA in that it
compresses the high-dimensional feature space, yet the core idea is not
to capture as much variance as possible with as few variables as
possible, but rather reveal latent (= invisible) variables, i.e.,
**factors**.

The computation bears some resemblance to that of PCA, with the main
difference being that an observation $x_m$ is assumed to be generated by
combinations of factor loadings
$\lambda_{1}, \lambda_{2}, \dots, \lambda_{mp}$ with the underlying
factors $\xi_{1}, \xi_{2}, \dots, \xi_{p}$ (see @eq-efa). Everything to
the right of the equation can only be obtained by running estimation
procedures such as Principle Axis Factoring or Maximum Likelihood
Estimation.

$$
x_1 = \lambda_{11}\xi_{11} + \lambda_{12}\xi_{12} + \dots + \lambda_{1p}\xi_{p} + \epsilon_1
$$ {#eq-efa}

When retrieving PCA and EFA loadings, several interpretive differences
must be kept in mind:

::: callout-note
## Key differences between EFA and PCA

-   **PCA**: PCA weights can be conceptualised as "directions in feature
    space along which the data vary the most" [@james_introduction_2021:
    503] and are analogous to regression slopes. Features with similar
    loadings on a given PC will be very close to each other in a biplot
    and could be understood as correlated with each other.

-   **EFA**: The factor loadings in an EFA, on the other hand, directly
    indicate how **strong** a factor is **correlated** with an existing
    independent variable in the dataset. As such, they help identify and
    interpret the underlying constructs that have given rise to the
    data. We can think of EFA loadings as regression coefficients
    **and** correlation coefficients at the same time.
:::

## Application in R

We use our insights from the PCA analysis, according to which three
latent variables are enough to capture the bulk of variance in the
dataset. When fitting an EFA model, principle axis factoring is the
default solution, but could also be changed to `fm = "ml"` to perform
Maximum Likelihood Estimation.

```{r}
efa1 <- fa(scope_sem_sub[,-1], nfactors = 3, rotate = "none", fm = "pa")
```

The remaining printing and plotting methods are identical to PCA.

-   Print loadings:

```{r}
loadings(efa1)
```

-   Plot loadings:

```{r}
plot(efa1, labels = colnames(scope_sem_sub[,-1]), main = NA)
```

-   Plot PA scores and loadings:

```{r}
biplot(efa1, choose = c(1, 2), main = NA,
       pch = 20, col = c("darkgrey", "blue"))


biplot(efa1, choose = c(2, 3), main = NA,
       pch = 20, col = c("darkgrey", "blue"))


```

### Rotation

Factors are typically rotated in order to aid in their interpretation,
resulting in much clearer loading patterns. ***Varimax*** **rotation**
is the default technique and does not affect the model fit (i.e., there
is no loss in explained variance; for details see
[@mairModernPsychometrics2018: 26-29].[^efa-1]

[^efa-1]: Varimax is a so-called orthogonal rotation technique and,
    therefore, does not introduce correlations between the factors. If
    correlated factors are explicitly desired, oblique rotations such as
    *oblimin* and *promax* provide apt alternatives
    [@mairModernPsychometrics2018: 27].

```{r}
efa2 <- fa(scope_sem_sub[,-1], nfactors = 3, rotate = "Varimax", fm = "pa")

loadings(efa2)
```

The rotated EFA object paints a picture that is very similar to the PCA
result from the previous unit.

```{r}
diagram(efa2, main = NA)
```

```{r}
biplot(efa2, choose = c(1, 2), main = NA,
       pch = 20, col = c("darkgrey", "blue"))

biplot(efa2, choose = c(2, 3), main = NA,
       pch = 20, col = c("darkgrey", "blue"))

```

::: callout-note
## Interpreting the EFA output

-   **Perception**: The first principle axis is once more loaded heavily
    (and positively) by increasing concreteness scores in addition to
    higher visual and haptic ratings. Moreover, they display strong
    linear relationships. The negative association with interoceptive
    ratings suggests that referents that tend be perceived directly with
    their senses (concreteness) do not tend to be perceived inside their
    body.

-   **Senses**: In PA2 we find the inverse pattern of PC2 â€“ very strong
    positive correlations with sense-related features and a weaker, yet
    notable negative correlation with selectional preference strength.
    If a verb has more senses, it tends to carry less information about
    its context.

-   **Ingestion**: Interoceptive ratings are no longer part of the
    picture, thus giving way to the gustatory and olfactory perception
    of referents.
:::
