{
  "hash": "e7c40b3d46198b4ebb592d8ff82e815d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Querying a corpus\"\nauthor: Vladimir Buskin\nformat:\n  html:\n    self-contained: true\n    theme: default\n    toc: true\n    number-sections: true\n    slide-number: true\n    incremental: false\n    slide-level: 3\n    scrollable: true\n    \neditor: visual\n---\n\n\n\n## Introduction\n\nThis section offers a short introduction to corpus queries in R. Our\ngoal will be to obtain data on the genitive alternation in British\nEnglish. To this end, we will rely on the British component of the\nInternational Corpus of English (ICE-GB).\n\n## Preparation\n\n### Directory structure\n\nIn order for R to be able to recognise the data, it is crucial to set up\nthe working directory correctly.\n\n1.  Make sure your R-script **and** the corpus (e.g., 'ICE-GB') are\n    stored in the **same folder**.\n2.  In RStudio, now navigate to `Session` \\> `Set working directory` \\>\n    `To Source File Location`. This ensures that the folder where you\n    have placed your R-script will function as your working directory\n    until you close RStudio again. To see your working directory in your\n    files pane, click on `Files` \\> `'Blue wheel symbol'` \\>\n    `Go to working directory`.\n\n### Installing and loading packages (move to earlier session)\n\nPackages expand the basic functionality of R by providing numerous\nquality-of-life improvements that not only considerably simplify common\ndata wrangling tasks but which also provide frameworks for\nstate-of-the-art methods for statistical analysis and natural language\nprocessing (NLP).\n\nIn order to install a package, you navigate to `Packages` \\> `Install`\nand verify that the pop-up window says\n`Install from: Repository (CRAN)`. You can now type in the name of the\npackage you would like to install under `Packages`.\n\n**Task**: Install the `tidyverse` and `quanteda` packages!\n\nOnce the installation has been completed, you can proceed to load the\nlibraries using the code below. You can ignore the warning messages.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n-- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --\nv dplyr     1.1.2     v readr     2.1.4\nv forcats   1.0.0     v stringr   1.5.0\nv ggplot2   3.5.0     v tibble    3.2.1\nv lubridate 1.9.2     v tidyr     1.3.0\nv purrr     1.0.1     \n-- Conflicts ------------------------------------------ tidyverse_conflicts() --\nx dplyr::filter() masks stats::filter()\nx dplyr::lag()    masks stats::lag()\ni Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(quanteda)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nPackage version: 3.3.1\nUnicode version: 14.0\nICU version: 70.1\nParallel computing: 8 of 8 threads used.\nSee https://quanteda.io for tutorials and examples.\n```\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'kableExtra'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n```\n\n\n:::\n:::\n\n\n\nRemember that you will have to reload these libraries whenever you start\na new R session (i.e., open RStudio).\n\n## Loading the corpus\n\nAfter specifying the working directory and loading the libraries we will\nneed, we can read in the corpus files into a corpus object in R.\n\nFirst, simply copy-paste the following code chunk at the beginning of\nyour R-script. Once you run it, it will load the function `read_GB()`\ninto R's working memory (it should now appear in the `Environment`\ntab!). This function will automatically handle the entire reading-in\nprocess.\n\nTo now get all corpus files into R, all we have to do is call the\nfunction:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nICE_GB <- readRDS(\"ICE_GB.RDS\")\n```\n:::\n\n\n\nIf you encounter error messages, make sure you followed steps 1 and 2\nabove.\n\n## Concordancing\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(quanteda)\nlibrary(tidyverse)\n\n# Load corpus\nICE_GB <- readRDS(\"ICE_GB.RDS\")\n```\n:::\n\n\n\n#### Basic use\n\n-   Concordances\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Query the corpus\nquery1 <- kwic(ICE_GB, pattern = \"provid(e|es|ing|ed)\", valuetype = \"regex\")\n\nquery1 %>%\n  as_tibble() %>% \n  count(keyword)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 x 2\n   keyword          n\n   <chr>        <int>\n 1 Provided         5\n 2 Provident        1\n 3 Providing        1\n 4 provide        165\n 5 provided       118\n 6 providential     1\n 7 provider         1\n 8 providers        3\n 9 provides        72\n10 providing       52\n```\n\n\n:::\n\n```{.r .cell-code}\n# Print first six lines to console\n#head(as_tibble(kwic_provide))\n\n# View output in separate window\n#View(kwic_provide)\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\\begin{table}\n\\centering\n\\begin{tabular}[t]{l|r|r|l|l|l|l}\n\\hline\ndocname & from & to & pre & keyword & post & pattern\\\\\n\\hline\nICE\\_GB/S1A-003.txt & 1994 & 1994 & > Uhm or whatever they & provide & < ICE-GB:S1A-003 \\#82 : 1 & provid(e|es|ing|ed)\\\\\n\\hline\nICE\\_GB/S1A-010.txt & 827 & 827 & quandary about what to to & provide & < , , > < & provid(e|es|ing|ed)\\\\\n\\hline\nICE\\_GB/S1A-023.txt & 3230 & 3230 & from there is Gospel Oak & provided & you know the time of & provid(e|es|ing|ed)\\\\\n\\hline\nICE\\_GB/S1A-024.txt & 1851 & 1851 & what L S E is & providing & < ICE-GB:S1A-024 \\#92 : 1 & provid(e|es|ing|ed)\\\\\n\\hline\nICE\\_GB/S1A-031.txt & 998 & 998 & her own < , > & providing & her < ICE-GB:S1A-031 \\#47 : & provid(e|es|ing|ed)\\\\\n\\hline\nICE\\_GB/S1A-038.txt & 730 & 730 & this as viewing banking as & providing & < , , > < & provid(e|es|ing|ed)\\\\\n\\hline\n\\end{tabular}\n\\end{table}\n\n\n:::\n:::\n\n\n\n#### Increase search window\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Query the corpus\nkwic_provide2 <- kwic(tokens(ICE_GB_corpus),\n                     pattern = \"provide\",\n                     window = 20) # choose window size\n\n# View output in separate window\n#View(kwic_provide)\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n\n#### Regular expressions\n\n**Regular expressions** (or 'regex') help us find more complex patterns\nin strings of text. Suppose we are interested in finding all\ninflectional forms of the lemma PROVIDE in a corpus, i.e., *provide,\nprovides, providing* and *provided*. Insteading of searching for all\nforms individually, we can construct a regular expression of the form\n\n$$\n\\text{provide(s | ing | ed)?}\n$$ which can be read as 'Match the sequence of letters \\<provide\\> as\nwell as when it is optionally followed by the letters \\<s\\> or \\<ing\\>\nor \\<ed\\>'. Notice how optionality is signified by the '?' operator and\nalternatives by '\\|'.\n\nTo activate regular expression in a KWIC query, simply set the\n`valuetype` argument to `\"regex\"`:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Query the corpus\nkwic_provide3 <- kwic(ICE_GB,\n                     pattern = \"provide(s|ing|ed)?\",\n                     valuetype = \"regex\", # query format\n                     window = 20)\n\n                     \n\n# View output in separate window\n#View(kwic_provide)\n```\n:::\n\n\n\nThe number of hits has more than doubled. However, upon closer\ninspection, we'll notice a number of false positives (e.g.,\n*providential*).\n\n\n\n::: {.cell}\n\n:::\n\n\n\n### RegEx: A Cheatsheet\n\n### Example usage\n\n### Exporting the results\n",
    "supporting": [
      "Concordancing_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{\"knit_meta_id\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"]}},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"normalem\"]},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]}]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}