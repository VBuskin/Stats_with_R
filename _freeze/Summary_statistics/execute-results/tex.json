{
  "hash": "8b8f77710d116aed2b787575d11fa08c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Continuous data\"\nauthor: Vladimir Buskin\nformat:\n  html:\n    self-contained: false\n    theme: default\n    toc: true\n    number-sections: true\n    slide-number: true\n    incremental: false\n    slide-level: 3\n    scrollable: true\neditor: visual\nbibliography: R.bib\n---\n\n\n\n\n\n## Preparation\n\nWe will use the dataset from the previous unit:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Libraries\nlibrary(\"readxl\")\nlibrary(\"tidyverse\")\n\n# Load data from working directory\ncl.order <- read_xlsx(\"Paquot_Larsson_2020_data.xlsx\")\n```\n:::\n\n\n\n## Measures of central tendency {.scrollable}\n\n### The mean {.smaller .scrollable}\n\nA useful summary statistic is the arithmetic mean $\\bar{x}$ [cf.\n@heumann_introduction_2022: 38]. Consider a continuous variable $X$ with\nobservations $x_1, x_2, ..., x_n$ from a sample of size $n$. The sample\nmean $\\bar{x}$ then corresponds to\n\n$$\n\\bar{x} = \\frac{x_1 + x_2 + ... + x_n}{n} \\\\ = \\frac{1}{n}\\sum_{i=1}^n{x_i}.\n$$\n\n::: callout-note\n## Hold on, what does this large Î£ symbol mean?\n\nThe summation symbol $\\sum$ is a concise way to express the sum of a\nsequence of numbers. It works like this:\n\n-   The expression below the $\\sum$ (e.g., $i = 1$) indicates the\n    starting value of the index $i$.\n\n-   The number above the $\\sum$ (e.g., $n$) is the ending value of the\n    index $i$.\n\n-   The expression to the right of the $\\sum$ (e.g., $x_i$) is the term\n    to be summed.\n\nFor instance, the expression $\\sum_{i=1}^n{x_i}$ means \"sum the values\nof $x_i$ starting from $i = 1$ up to $i = n$.\" In other words, it adds\nup the values $x_1 + x_2 + \\dots + x_n$.\n:::\n\nIn R, we can obtain the average value of a numeric vector with the\n`mean()` function. Let's do that for the length of main clauses found in\nthe `cl.order` data:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Using mean()\nmean(cl.order$LEN_MC)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 9.265509\n```\n\n\n:::\n:::\n\n\n\n::: {.callout-tip collapse=\"true\" title=\"Compute the sample mean by hand\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean <- 1/length(cl.order$LEN_MC) * sum(cl.order$LEN_MC)\n```\n:::\n\n\n:::\n\nThe output returned by this function provides a one-value summary of all\nobservations contained in `LEN_MC`. How could we visualise it?\n\nFirst, let's create a histogram of `LEN_MC`. Histograms summarise how\noften certain values occur in a continuous variable. The blue line\nindicates the sample mean. Alternatively, you can use a density plot to\nrepresent the probability of encountering a specific value in the data.\n\n::: panel-tabset\n### Histogram (ggplot2)\n\n\n\n::: {.cell warnings='false'}\n\n```{.r .cell-code}\n# Plot distribution of LEN_MC\ncl.length.hist <- ggplot(cl.order, aes(x = LEN_MC)) +\n                  geom_histogram(binwidth = 2)\n\ncl.length.hist +\n  # Add mean\n  geom_vline(aes(xintercept = mean(LEN_MC)),\n             color = \"steelblue\",\n             linewidth = 1) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-4-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n### Density plot (ggplot2)\n\n\n\n::: {.cell warnings='false'}\n\n```{.r .cell-code}\n# Plot distribution of LEN_MC\ncl.length.dens <- ggplot(cl.order, aes(x = LEN_MC)) +\n                  geom_density()\n\ncl.length.dens +\n  # Add mean\n  geom_vline(aes(xintercept = mean(LEN_MC)),\n             color = \"steelblue\",\n             linewidth = 1) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-5-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n### Histogram (Base R)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(cl.order$LEN_MC)\n  abline(v=mean(cl.order$LEN_MC),lwd=3, col = \"steelblue\")\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-6-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n### Density plot (Base R)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(density(cl.order$LEN_MC))\n  abline(v=mean(cl.order$LEN_MC),lwd=3, col = \"steelblue\")\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-7-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n:::\n\n### The median {.smaller}\n\nThe `median()` function computes the \"the halfway point of the data (50%\nof the data are above the median; 50% of the data are below\"\n[@winter_statistics_2020: 58].\n\n$$\n\\tilde{x}_{0.5} = \n\\begin{cases}\nx_{((n+1)/2)} & \\text{if } n \\text{ is odd.} \\\\\n\\frac{1}{2}(x_{n/2}+x_{(n/2+1)}) & \\text{if } n \\text{ is even.}\n\\end{cases} \n$$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Using median()\nmedian(cl.order$LEN_MC)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 8\n```\n\n\n:::\n:::\n\n\n\n::: {.callout-tip collapse=\"true\" title=\"Compute the median by hand\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsample_sorted <- sort(cl.order$LEN_MC) # sort values in ascending order\n\nn <- length(cl.order$LEN_MC) # sample size is 403 (odd number!)\n\nmedian <- sample_sorted[(n + 1) %/% 2] # compute median\n```\n:::\n\n\n:::\n\nThe median of `LEN_MC` is represented by the red vertical line.\n\n::: panel-tabset\n### Histogram (ggplot2)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncl.length.hist +\n  # Add mean\n  geom_vline(aes(xintercept = mean(LEN_MC)), color = \"steelblue\", linewidth = 1) +\n  # Add median\n  geom_vline(aes(xintercept = median(LEN_MC)), color = \"red\", linewidth = 1) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-10-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n### Density plot (ggplot2)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncl.length.dens +\n  # Add mean\n  geom_vline(aes(xintercept = mean(LEN_MC)), color = \"steelblue\", linewidth = 1) +\n  # Add median\n  geom_vline(aes(xintercept = median(LEN_MC)), color = \"red\", linewidth = 1) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-11-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n### Histogram (Base R)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(cl.order$LEN_MC)\n  abline(v=mean(cl.order$LEN_MC),lwd=3, col = \"steelblue\")\n  abline(v=median(cl.order$LEN_MC),lwd=3, col = \"red\")\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-12-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n### Density plot (Base R)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(density(cl.order$LEN_MC))\n  abline(v=mean(cl.order$LEN_MC),lwd=3, col = \"steelblue\")\n  abline(v=mean(cl.order$LEN_MC),lwd=3, col = \"red\")\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-13-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n:::\n\n### Sample variance and standard deviation {.smaller}\n\nIn order to assess how well the mean represents the data, it is\ninstructive to compute the **variance** `var()` and the **standard\ndeviation** `sd()` for a sample.\n\nThe sample variance $s^2$ is defined as\n\n$$s^2 = \\frac{1}{n}\\sum_{i=1}^n{(x_i - \\bar{x})^2}. $$\n\nIn other words, it stands for the average squared deviation of all\nobservations from the sample mean.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Using var()\nvar(cl.order$LEN_MC)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 25.12585\n```\n\n\n:::\n:::\n\n\n\n::: {.callout-tip collapse=\"true\" title=\"Compute the sample variance by hand\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define sample\nsample_data <- cl.order$LEN_MC\n\n# Calculate the sample standard deviation\nvar <- 1 / length(sample_data) * sum((sample_data - mean(sample_data))^2) # formula above\n\n# Note that R's var() function applies an additional bias correction measure:\nvar_corrected <- 1 / (length(sample_data) - 1) * sum((sample_data - mean(sample_data))^2) # equivalent to var()\n```\n:::\n\n\n:::\n\nCorrespondingly, the standard deviation of the mean is the square root\nof the variance [cf. @heumann_introduction_2022: 51-2].\n\n$$ s = \\sqrt{\\frac{1}{n}\\sum_{i=1}^n{(x_i - \\bar{x})^2}} $$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Using sd()\nsd(cl.order$LEN_MC)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 5.012569\n```\n\n\n:::\n\n```{.r .cell-code}\n# or by hand:\n\nsample_data <- cl.order$LEN_MC\n```\n:::\n\n\n\n::: {.callout-tip collapse=\"true\" title=\"Compute the sample standard deviation by hand\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsd <- sqrt(1 / (length(sample_data) - 1)* sum((sample_data - mean(sample_data))^2))\n```\n:::\n\n\n:::\n\n**Visualisation**:\n\n::: panel-tabset\n#### Example 1\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncl.length.hist +\n  # Add verticle line for the mean\n  geom_vline(aes(xintercept = mean(LEN_MC)), color = \"steelblue\", linewidth = 1) +\n  # Add -1sd\n  geom_vline(aes(xintercept = mean(LEN_MC) - sd(LEN_MC)), color = \"orange\", linewidth = 1) +\n  # Add +1sd\n  geom_vline(aes(xintercept = mean(LEN_MC) + sd(LEN_MC)), color = \"orange\", linewidth = 1) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-18-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n#### Example 2\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create data frame with mean and sd for each clause ORDER\n\ncl.order %>% \n  # Select variables of interest\n  select(ORDER, LEN_MC) %>% \n  # Group results of following operations by ORDER\n  group_by(ORDER) %>% \n    # Create grouped summary of mean and sd for each ORDER\n    summarise(mean = mean(LEN_MC),\n                sd = sd(LEN_MC)) -> cl_mean_sd; cl_mean_sd\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 x 3\n  ORDER  mean    sd\n  <chr> <dbl> <dbl>\n1 mc-sc  9.04  4.91\n2 sc-mc  9.75  5.22\n```\n\n\n:::\n\n```{.r .cell-code}\n# Plot results \n\nggplot(cl_mean_sd, aes(x = ORDER, y = mean)) +\n  # Barplot with a specific variable mapped onto y-axis\n  geom_col() +\n  # Add mean and standard deviation to the plot\n  geom_errorbar(aes(x = ORDER,\n                    ymin = mean-sd,\n                    ymax = mean+sd), width = .2) +\n  theme_classic() +\n  labs(y = \"Mean length of main clauses\", x = \"Clause order\")\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-19-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n:::\n\n### Quantiles\n\nWhile `median()` divides the data into two equal sets (i.e., two 50%\nquantiles), the `quantile()` function makes it possible to partition the\ndata further.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquantile(cl.order$LEN_MC)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  0%  25%  50%  75% 100% \n   2    6    8   11   31 \n```\n\n\n:::\n:::\n\n\n\n`quantile(x, 0)` and `quantile(x, 1)` thus show the minimum and maximum\nvalues, respectively.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquantile(cl.order$LEN_MC, 0)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n0% \n 2 \n```\n\n\n:::\n\n```{.r .cell-code}\nquantile(cl.order$LEN_MC, 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n100% \n  31 \n```\n\n\n:::\n:::\n\n\n\n### Quartiles and boxplots\n\nConsider the distribution of clause length by clause order:\n\n::: panel-tabset\n#### Boxplot (Base R)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(LEN_MC ~ ORDER, cl.order)\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-22-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n#### Boxplot (ggplot2)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(cl.order, aes(x = ORDER, y = LEN_MC)) +\n  geom_boxplot() +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-23-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n:::\n\nCompare it to the corresponding rotated density plot:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(cl.order, aes(x = LEN_MC, fill = ORDER)) +\n  geom_density(alpha = 0.5) +\n  coord_flip() +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-24-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n## Visualising mixed data\n\n### A numerical and categorical variable\n\n-   Boxplot with `geom_boxplot()`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(cl.order, aes(x = ORDER, y = LEN_MC)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-25-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n-   Densitiy plot using the optional arguments `color` and/or `fill`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(cl.order, aes(x = LEN_MC, fill = ORDER)) +\n  geom_density(alpha = 0.5)\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-26-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n-   A barplot with `geom_col()`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(cl.order, aes(x = ORDER, y = LEN_MC)) +\n  geom_col(aes(x = ORDER, y = LEN_MC))\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-27-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n### Multivariate plots\n\n-   Advanced scatterplot with four variables: `LEN_MC` (x), `LEN_SC`\n    (y), `ORDER` (colour) and `SUBORDTYPE` (shape)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 4 variables\nggplot(cl.order, aes(x = LEN_MC, y = LEN_SC)) +\n  geom_point(aes(color = ORDER, shape = SUBORDTYPE))\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-28-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n-   Facets\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 5 variables\nggplot(cl.order, aes(x = LEN_MC, y = LEN_SC)) +\n  geom_point(aes(color = ORDER, shape = SUBORDTYPE)) +\n  facet_wrap(~MORETHAN2CL)\n```\n\n::: {.cell-output-display}\n![](Summary_statistics_files/figure-pdf/unnamed-chunk-29-1.pdf){fig-pos='H'}\n:::\n:::\n",
    "supporting": [
      "Summary_statistics_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}