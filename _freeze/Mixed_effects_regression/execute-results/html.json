{
  "hash": "cfa4c80d6add04f4dad3cc97f517a8fc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Mixed-effects regression\"\nauthor:\n  name: \"Vladimir Buskin\" \n  orcid: \"0009-0005-5824-1012\"\n  affiliation: \n    name: \"Catholic University of Eichstätt-Ingolstadt\"\n    department: \"English Language and Linguistics\"\nformat:\n  html:\n    self-contained: true\n    logo: logo.png\n    footer: \"Regression\"\n    theme: Reference\n    toc: true\n    number-sections: true\n    slide-number: true\n    incremental: false\n    slide-level: 4\n    scrollable: true\neditor: visual\nbibliography: R.bib\n---\n\n\n## Recommended reading\n\nFor linguists:\n\n> @paquot_mixed-effects_2020\n\nGeneral:\n\n> @gelmanDataAnalysisUsing2007\n\n## Preparation\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load libraries\nlibrary(tidyverse)\nlibrary(broom)\nlibrary(broom.mixed)\nlibrary(tidyr)\nlibrary(lme4) # for linear mixed-effects models\nlibrary(sjPlot)\nlibrary(ggeffects)\nlibrary(ggpubr)\n\n# Load data\nvarmorph <- read.csv(\"varmorph_data.csv\", header = TRUE)\n\n# Reduce data\nvarmorph %>%\n  select(rt, target, prime_type, subj_id) %>%\n  filter(prime_type != \"filler\") %>% \n  drop_na() -> varmorph2\n\n# Overview\nglimpse(varmorph2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 7,038\nColumns: 4\n$ rt         <dbl> 599.63, 885.39, 1124.94, 568.68, 726.24, 1095.37, 492.96, 6…\n$ target     <chr> \"print\", \"defend\", \"tempt\", \"hunt\", \"staple\", \"pose\", \"kick…\n$ prime_type <chr> \"derived\", \"derived\", \"derived\", \"derived\", \"derived\", \"der…\n$ subj_id    <chr> \"3202\", \"3202\", \"3202\", \"3202\", \"3202\", \"3202\", \"3202\", \"32…\n```\n\n\n:::\n:::\n\n\n## Multilevel models {#sec-mer}\n\nAt their core, mixed-effects models \"are extensions of regression in\nwhich data are structured in groups and coefficients can vary by group\"\n[@gelmanDataAnalysisUsing2007: 237]. Typical grouping structures found\nin linguistic data include speakers, regions, or lexical stimuli for\nwhich **multiple observations** are attested. Normally, such structures\nwould violate the assumption of independence, but can be controlled for\nby capturing group-wise tendencies.\n\nFor illustration, a simple example of a hierarchical dataset is\npresented in @fig-multi-simple. If one were to, for instance, measure\ntest scores for every student, it may be of interest how their\nperformance varies not only from student to student but also from school\nto school. After all, the students are **nested** within their schools.\n\n::: {#fig-multi-simple}\n\n```{mermaid}\n%%| fig-width: 4\n%%| fig-height: 4\ngraph LR\n    A1[School 1] --> B11(Student 1)\n    A1[School 1] --> B12(Student 2)\n    A1[School 1] --> B13(Student 3)\n    \n    A2[School 2] --> B21(Student 4)\n    A2[School 2] --> B22(Student 5)\n    A2[School 2] --> B23(Student 6)\n    \n```\n\n:::\n\n::: callout-caution\n## Task\n\nRead the following (partial) description of the experiments conducted by\nCiaccio & Veríssimo on the morphological processing of complex lexical\nitems [-@ciaccioInvestigatingVariabilityMorphological2022]:\n\n> Sixty-nine intermediate to advanced non-native speakers of English (54\n> women; 15 men) took part in the experiment in exchange for payment or\n> course credits. \\[...\\] The experiment included 102 English\n> monomorphemic verbs used as targets (e.g., *print*). These were\n> preceded by their -*ed* past-tense form (e.g., *printed*) as the\n> inflected prime, their -*er* nominalization (e.g., *printer*) as the\n> derived prime, or by an unrelated prime. Unrelated primes were\n> dissimilar in form and meaning from their corresponding targets; half\n> of them were -*ed* inflected forms and half of them were -*er* derived\n> words. [@ciaccioInvestigatingVariabilityMorphological2022: 2267]\n\nInspect `varmorph2` and characterise its multilevel structure.\n:::\n\n### Types of mixed-effects models\n\nVariance across groups can be captured by **varying-intercept** and/or\n**varying-slope** models. These varying coefficients also known as\n**random effects** (cf. @gelmanDataAnalysisUsing2007: 245). In the model\nequation, the intercept $\\alpha$ and/or the slope $\\beta$ is\nadditionally indexed for the grouping factor. Let $J$ denote the number\nof groups for $j = 1, ..., J$.\n\n::: callout-note\n## Varying-intercept model\n\nWe allow group-wise variation in the intercept by replacing $\\alpha$\nwith $\\alpha_{j}$ to indicate the intercept for the $j$-th group. It is\ndefined as a random variable and follows the normal distribution. For\ninstance, each participant in the aforementioned psycholinguistic would\nreceive its own intercept rather than a global one for all participants.\n\n$$\nY = \\alpha_{j} + \\beta_1X_{1} + \\beta_2X_{2} + ... + \\epsilon \\qquad \\alpha_{j} \\sim N(\\mu_{\\alpha}, \\sigma_{\\alpha}^2) \n$$ {#eq-rnd-intercept}\n:::\n\n::: callout-note\n## Varying-slope model\n\nWe will allow group-wise variation in the slope coefficients by\nreplacing them with $\\beta_{ij}$ to indicate the slope for the $j$-th\ngroup. The slope now functions as a random variable and is normally\ndistributed. In the psycholinguistic study, each participant would be\nassigned its own slope coefficient.\n\n$$\nY = \\alpha + \\beta_{1j}X_{1} + \\beta_{2j}X_{2} + ... + \\epsilon \\qquad \\beta_{j} \\sim N(\\mu_{\\beta}, \\sigma_{\\beta}^2) \n$$ {#eq-rnd-slope}\n:::\n\n### Example\n\nAssume we are predicting test performance by `School`. Using simulated\ndata, the following series of plots plots illustrate ...\n\n(1) ... `School` as a fixed effect,\n\n(2) ... random intercepts for each `School`,\n\n(3) ... random slopes for each `School`, and\n\n(4) ... random intercepts and slopes for each `School`.\n\n\n::: {.cell}\n\n:::\n\n\n::: {.callout-note title=\"Plot: (1) Fixed-effects model\" collapse=\"true\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](Mixed_effects_regression_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n:::\n\n::: {.callout-note title=\"Plot: (2) Varying-intercept model\" collapse=\"true\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](Mixed_effects_regression_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n:::\n\n::: {.callout-note title=\"Plot: (3) Varying-slope model\" collapse=\"true\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](Mixed_effects_regression_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n:::\n\n::: {.callout-note title=\"Plot: (4) Varying-intercept and varying-slope model\" collapse=\"true\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](Mixed_effects_regression_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n:::\n\n### Linear mixed-effects models\n\n### Application in R\n\n#### Varying-intercept model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Varying intercept model\n\n# Define reference level for \"prime_type\"\nvarmorph2$prime_type <- factor(varmorph2$prime_type, levels = c(\"unrelated\", \"derived\", \"inflected\"))\n\n# Fit mixed-effects models\nvarmorph.me <- lmer(rt ~ prime_type + # fixed effect\n                      (1 | subj_id) + # let intercept vary by subject\n                      (1 | target), # # let intercept vary by target word\n                      data = varmorph2)\n\n# Summarise results\nsummary(varmorph.me)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntab_model(varmorph.me, show.se = TRUE, show.aic = TRUE, show.dev = TRUE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"4\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">rt</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">std. Error</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">715.70</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">12.66</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">690.89&nbsp;&ndash;&nbsp;740.52</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">prime type [derived]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;31.31</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.01</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;41.14&nbsp;&ndash;&nbsp;-21.48</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">prime type [inflected]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;33.96</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.01</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;43.78&nbsp;&ndash;&nbsp;-24.13</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td colspan=\"5\" style=\"font-weight:bold; text-align:left; padding-top:.8em;\">Random Effects</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&sigma;<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">29483.89</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>00</sub> <sub>target</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">3690.56</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>00</sub> <sub>subj_id</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">7693.61</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">ICC</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">0.28</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>subj_id</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">69</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>target</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">102</td>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"4\">7038</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">0.006 / 0.283</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">Deviance</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">92860.321</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">AIC</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">92855.624</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n::: {.callout-tip title=\"ICC\"}\nThe intraclass correlation coefficient (ICC) \"ranges from $0$ if the\ngrouping conveys no information to $1$ if all members of a group are\nidentical\" [@gelmanDataAnalysisUsing2007: 258]. In other words, it\nindicates how much of the variance in the outcome can be explained by\nthe grouping factor (e.g. school or participant).\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Extract random effects and their standard errors\nranef_obj <- ranef(varmorph.me)  # Extract random effects with conditional variance\nse_ranef <- arm::se.ranef(varmorph.me)           # Extract standard errors for random effects\n\n# Prepare a data frame for 'subj_id' random intercepts with confidence intervals\nsubj_ranef <- ranef_obj$subj_id  # Random effects for subjects\nsubj_se <- se_ranef$subj_id      # Standard errors for subjects\n\n# Combine random effects and standard errors into a data frame\nsubj_df <- data.frame(\n  subj_id = rownames(subj_ranef),\n  intercept = subj_ranef[, \"(Intercept)\"],\n  se = subj_se[, \"(Intercept)\"],\n  conf.low = subj_ranef[, \"(Intercept)\"] - 1.96 * subj_se[, \"(Intercept)\"],\n  conf.high = subj_ranef[, \"(Intercept)\"] + 1.96 * subj_se[, \"(Intercept)\"]\n)\n\n# Create the waterfall plot\nggplot(subj_df, aes(x = reorder(subj_id, intercept), y = intercept)) +\n  geom_hline(yintercept = 0, linetype = \"dashed\", col = \"grey10\") +\n  geom_pointrange(aes(ymin = conf.low, ymax = conf.high)) +\n  coord_flip() +\n  geom_vline(xintercept = 0, linetype = \"dashed\", col = \"grey10\") +\n  labs(title = \"Random Intercepts by Subject\",\n       x = \"Subject ID\",\n       y = \"Random Intercept\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Mixed_effects_regression_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n#### Varying-slope model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Varying-slope model; replace 0 with 1 if you want the intercept to vary too\nvarmorph.me2 <- lmer(rt ~ prime_type +\n                      (0 + prime_type | subj_id),\n                      data = varmorph2)\n\nsummary(varmorph.me2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntab_model(varmorph.me2, show.se = TRUE, show.aic = TRUE, show.dev = TRUE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"4\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">rt</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">std. Error</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">715.70</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">11.11</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">693.92&nbsp;&ndash;&nbsp;737.49</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">prime type [derived]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;31.31</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.57</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;42.23&nbsp;&ndash;&nbsp;-20.39</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">prime type [inflected]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;33.96</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.32</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;44.38&nbsp;&ndash;&nbsp;-23.53</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td colspan=\"5\" style=\"font-weight:bold; text-align:left; padding-top:.8em;\">Random Effects</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&sigma;<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">33126.00</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>00</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">&nbsp;</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>00</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">&nbsp;</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>11</sub> <sub>subj_id.prime_typeunrelated</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">7545.01</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>11</sub> <sub>subj_id.prime_typederived</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">8193.86</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>11</sub> <sub>subj_id.prime_typeinflected</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">7385.08</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&rho;<sub>01</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">&nbsp;</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&rho;<sub>01</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">&nbsp;</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">ICC</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">0.14</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>subj_id</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">69</td>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"4\">7038</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">0.006 / 0.141</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">Deviance</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">93452.160</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">AIC</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">93455.369</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Extract random slopes\nranef_data1 <- ranef(varmorph.me2)$subj_id\n\n# Extract standard errors\nranef_data1_se <- arm::se.ranef(varmorph.me2)$subj_id\n\n# Convert data into long format\nrandom_effects_df <- ranef_data1 %>%\n  as.data.frame() %>% \n  rownames_to_column(var = \"subj_id\") %>%\n  pivot_longer(cols = -subj_id, \n               names_to = \"prime_type\", \n               values_to = \"random_effect\")\n\n\n# Create a data frame for standard errors\nse_df <- as.data.frame(ranef_data1_se) %>%\n  rownames_to_column(var = \"subj_id\") %>%\n  pivot_longer(cols = -subj_id, \n               names_to = \"prime_type\", \n               values_to = \"se\")\n\n\n# Combine random effects with standard errors\ncombined_df <- random_effects_df %>%\n  left_join(se_df, by = c(\"subj_id\", \"prime_type\"))\n\n# Calculate confidence intervals\ncombined_df <- combined_df %>%\n  mutate(lower_ci = random_effect - 1.96 * se,\n         upper_ci = random_effect + 1.96 * se)\n\n\n# Dotplots with confidence intervals\nggplot(combined_df, aes(x = subj_id, y = random_effect, col = prime_type)) +\n  coord_flip() +\n  geom_point() +\n  geom_hline(yintercept = 0, linetype = \"dashed\", col = \"grey10\") +\n  facet_wrap(~ prime_type) +\n  geom_errorbar(aes(ymin = lower_ci, ymax = upper_ci), width = 0.2) +\n  labs(title = \"Random Effect of Prime Type by Subject ID\",\n       x = \"Random Slope\",\n       y = \"Subject ID\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))\n```\n\n::: {.cell-output-display}\n![](Mixed_effects_regression_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Mixed_effects_regression_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}